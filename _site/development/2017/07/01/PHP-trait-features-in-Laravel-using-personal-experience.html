<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> PHP trait 特性在 Laravel 中的使用个人心得 </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> 麦索的麦田 </h1>
        <h2>Nothing is impossible</h2>
        <a href="/" class="button"><small>go back</small>Index</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          
          <h2>PHP trait 特性在 Laravel 中的使用个人心得</h2>
<p class="meta">2017-07-01</p>

<p>trait 是在PHP5.4中为了方便代码复用的一种实现方式，但目前我在看的的PHP项目中较少看的有程序员去主动使用这个实现方式，在laravel中有很多 trait 的使用，关于trait 在 laravel 的使用请参看 Laravel 在哪些地方用了 trait?</p>

<p>我曾在 Laravel 中大型项目面向对象架构 引用分享过一个他人的架构设计实践，在他的实践中大量使用了依赖注入。这是一种可行的方式，而同样的使用 trait 可以实现同样的功能，而且应用场景更多。</p>

<h3 id="model-中使用">model 中使用</h3>

<p>model是随着项目的推移会慢慢的变得肥大难以维护，因为传统的方式是将数据库访问逻辑都写在这里面，而 laravel 的模型里除了数据访问的逻辑还会有数据表之间的关联关系，访问器，修改器，监视的字段，白名单，黑名单等等。</p>

<p>而当一个模型在有了这么多东西后模型就会出现维护困难问题，当然数据访问可以通过 资源库模式（Repository）进行分离，但当项目已经有很多数据访问写在模型里使用资源库模式就是一个费力费时的改造工程。</p>

<p>而使用 trait 既可以实现代码分离又可以不用在逻辑层做任何处理。</p>

<p>我们只需要创建一个trait，将数据访问的所有方法全部移动到这个trait中，然后在原来的模型中 use 这个trait就可以了，这样就方便的实现了代码的分离。</p>

<p>同样的你可以将访问器，修改器分离，甚至是常常使用的模型定义，比如laravel的软删除就是用这种方式实现的，你可以自己定义一些常用的模型功能代码，比如内容的审核功能。</p>

<p>我的建议是将model放在models文件夹中，其他trait放在models中建立的文件夹中，这样就近的方便查找修改，比如我就将访问器修改器放在app/Models/Attribuite文件夹中，然后使用模型名类型名的驼峰命名文件。 比如 User 模型的访问器修改器我的文件路径就是app/Models/Attribuite/UserAttribute.php。</p>

<p>当然你可以分的更加细致，把访问器单独定义一个trait，修改器单独定义一个。</p>

<p>app/Models/Attribuite/UserGetAttribute.php app/Models/Attribuite/UserSetAttribute.php</p>

<h3 id="controller-中的使用">Controller 中的使用</h3>

<p>在laravel中有一个基类控制器里面已经有几个trait的使用了，比如认证，验证器，我们在使用基类控制器时候如果有较少的基类方法可以直接写在这个基类控制器里，当有很多的时候维护和查找他们也是一个麻烦事，这时候就可以用trait将他们分类出来。</p>

<p>而一些要复用的代码可能只在几个控制器里需要用到，这时候可以仅仅在这几个控制器里使用定义好的trait。</p>

<p>还有一种使用方式是控制器分离，当控制器中有越来越多方法时候，分离控制器中的方法也是必要的，一般的做法是新建一个控制器，然后将一些原来控制器中的方法移动过去，然后再去修改路由配置。用trait可以实现分离而不需要修改路由配置，新建一个trait将需要分离的方法移动过去，然后在原控制器中使用这个 trait 。</p>


<!--PC和WAP自适应版-->
<div id="SOHUCS" sid="PHP trait 特性在 Laravel 中的使用个人心得" ></div>
<script type="text/javascript">
(function(){
var appid = 'cyt8K3bay';
var conf = 'prod_4cce8456a31ddba41cd9cd6ae71a8ee7';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("http://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>


        </section>

        <aside id="sidebar">
          <!--<a href="https://github.com/pietromenna/jekyll-architect-theme/archive/master.zip" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/pietromenna/jekyll-architect-theme/archive/master.tar.gz" class="button">
            <small>Download</small>
            .tar.gz file
          </a>-->

          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
        </aside>
      </div>
    </div>

  </body>
</html>
